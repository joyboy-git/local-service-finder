<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login - Local Service Finder</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body class="bg-dark text-white">
  <div class="container d-flex justify-content-center align-items-center" style="height: 100vh;">
    <div class="card bg-dark text-white border-secondary p-4 w-100" style="max-width: 400px;">
      <h2 class="text-center mb-4">Login</h2>
      <form id="loginForm">
        <div class="mb-3">
          <label for="username" class="form-label">Username</label>
          <input type="text" class="form-control" id="username" placeholder="Enter username" required />
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Password</label>
          <div class="input-group">
            <input type="password" class="form-control" id="password" placeholder="Enter password" required />
            <button class="btn btn-outline-secondary" type="button" id="togglePassword">üëÅ</button>
          </div>
        </div>
        <button type="submit" class="btn btn-primary w-100">Log In</button>
        <div id="errorMsg" class="alert alert-danger mt-3 py-2" style="display:none;"></div>
        <!-- Add below 'Log In' button in your form -->
        <button type="button" class="btn btn-outline-light w-100 mt-2" data-bs-toggle="modal"
          data-bs-target="#registerModal">
          Register
        </button>

      </form>
    </div>
  </div>
  <!-- Registration Modal (Place this outside your main card div, but inside <body>) -->
  <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content bg-dark text-white border-secondary">
        <div class="modal-header">
          <h5 class="modal-title" id="registerModalLabel">Create Account</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form id="registerForm">
          <div class="modal-body">
            <div class="mb-3">
              <label for="regUsername" class="form-label">Username</label>
              <input type="text" class="form-control" id="regUsername" required>
            </div>
            <div class="mb-3">
              <label for="regEmail" class="form-label">Email</label>
              <input type="email" class="form-control" id="regEmail" required>
            </div>
            <div class="mb-3">
              <label for="regPassword" class="form-label">Password</label>
              <input type="password" class="form-control" id="regPassword" required>
            </div>
            <div id="regMsg" class="alert alert-danger mt-3 py-2" style="display:none;"></div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary w-100">Register</button>
          </div>
        </form>
      </div>
    </div>
  </div>


  <script>
    const validUsers = {
      Ganga_sai: "bachi65t",
      Jaya_prakash: "jp143",
      Siddu: "naral05"
    };

    // Toggle password visibility
    document.getElementById("togglePassword").addEventListener("click", () => {
      const passField = document.getElementById("password");
      passField.type = passField.type === "password" ? "text" : "password";
    });

    // Form validation
    document.getElementById("loginForm").addEventListener("submit", function (event) {
      event.preventDefault();
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      const errorMsg = document.getElementById("errorMsg");

      if (validUsers[username] && validUsers[username] === password) {
        // if valid go
        window.location.href = "local.html";
      } else {
        errorMsg.style.display = "block";
        errorMsg.textContent = "‚ùå Invalid username or password.";
      }
    });
    document.getElementById("registerForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const username = document.getElementById("regUsername").value.trim();
      const email = document.getElementById("regEmail").value.trim();
      const password = document.getElementById("regPassword").value.trim();
      const regMsg = document.getElementById("regMsg");
      // Simple AJAX call (adjust endpoint for your PHP backend)
      fetch("register.php", {
        method: "POST",
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: `username=${encodeURIComponent(username)}&email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`
      })
        .then(response => response.text())
        .then(data => {
          if (data === "success") {
            regMsg.classList.remove("alert-danger");
            regMsg.classList.add("alert-success");
            regMsg.style.display = "block";
            regMsg.textContent = "‚úÖ Registration successful! You can now log in.";
            setTimeout(() => { document.querySelector('.btn-close').click(); }, 2000);
          } else {
            regMsg.classList.add("alert-danger");
            regMsg.style.display = "block";
            regMsg.textContent = data;
          }
        })
        .catch(() => {
          regMsg.style.display = "block";
          regMsg.textContent = "‚ùå Registration failed.";
        });
    });

  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>